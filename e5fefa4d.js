import{i as H,s as L,R as T,x as p}from"./b2a733a2.js";import{_ as r,g as B,t as q,o as N,a as h,f as u,q as j,h as f,j as k,k as w,i as Q,d as S,w as X,e as $}from"./a5f335ce.js";import{n as c}from"./3f461019.js";var P=Object.freeze,_=Object.defineProperty,G=(d,n)=>P(_(d,"raw",{value:P(n||d.slice())})),D;class x{}x.cssBase=H(D||(D=G(['\n        :host{\n            display: block;\n        }\n\n        .escudo {\n            width: 100px; /* Ajusta el tama\xF1o del escudo seg\xFAn tus preferencias */\n            height: auto;\n        }\n\n        .quiniela {\n            display: flex;\n            flex-direction: column;\n            width: 100%;\n        }\n\n        .equipos {\n            display: flex;\n            width: 100%;\n            padding-left: 10px;\n            overflow: hidden;\n        }\n\n        .equipo {\n            max-width: 100%;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n        }\n\n        .partido {\n            display: flex;\n            align-items: center;\n            width: 100%;\n        }\n\n        .puntos {\n            flex-grow: 1; /* Permite que la clase .puntos tome el espacio restante disponible */\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n        }\n\n        .opciones{\n            display: flex;\n            text-align: center;\n            white-space: nowrap;\n            width: 80px;\n            margin: 0 auto;\n            background-color: #ff9990;\n            white-space: nowrap;\n            font-size: 13px;\n            padding-left: 10px;\n            padding-right: 10px;\n            padding-top: 3px;\n            padding-bottom: 3px;\n        }\n\n        .elecciones{\n            text-align: center;\n            padding: 3px;\n            cursor:pointer;\n            width: 20px;\n            height: 19px;\n            margin-left: 3px;\n            background-color: #FFF;\n            color: #ff9990;\n            font-size: 13px;\n            text-transform: uppercase;\n            font-weight: 700;\n        }\n\n        .opcionesRegistrada {\n            justify-content: center;\n            align-items: center;\n            display: flex;\n            text-align: center;\n            margin: 0px auto;\n            background-color: rgb(255, 153, 144);\n            white-space: nowrap;\n            font-size: 13px;\n            padding: 3px 10px;\n        }\n\n        .eleccionesRegistrada{\n            text-align: center;\n            padding: 3px;\n            cursor:pointer;\n            width: 20px;\n            height: 19px;\n            margin-left: 3px;\n            background-color: #FFF;\n            color: #ff9990;\n            font-size: 13px;\n            text-transform: uppercase;\n            font-weight: 700;\n        }\n\n        .numPartido{\n            padding-right: 10px;\n            padding-left: 5px;\n            font-weight: 700;\n        }\n\n        .pink-line-double {\n            border: 0;\n            width: 100%;\n            height: 3px;\n            background-color: #ff9990;\n            margin: 0;\n        }\n\n        h2{\n            font-size: 30px;\n            font-family: "oswaldFontLight", Arial, sans-serif;\n            \n        }\n\n        .information{\n            background-color: #00245c;\n            color: #ffffff;\n            margin-top: 10px;\n            margin-bottom: 0px;\n            display: flex;\n            align-items: center;\n            justify-content: space-around;\n        }\n\n        .selected {\n            background-color: yellow;\n        }\n\n        .mensajeQuinielaRegistrada{\n            font-size: 13px;\n            width: 40%;\n            color: #00245c;\n        }\n\n        .container{\n            display: flex;\n            width: 100%;\n            height: 90vh;\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        .playerContainer{\n            display: flex;\n            flex-grow: 1;\n            background-color: green;\n        }\n\n        .player{\n            background-color: blue;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n\n\n       \n\n    ']))),x.PanelPageTheme=[x.cssBase];class s extends L{constructor(){super(),this.isAdmin=!1,this.open=!1,this.openSeleccionarJornadas=!1,this.validarJornada=!1,this.tituloJornada="",this.equipos=[],this.fechaHoraInicio=null,this.partidos2=[],this.partidos=[],this.jornadas=[],this.jornadaSeleccionada="",this.selectedOptions={},this.handleEquipoSeleccionado=(a,e,o)=>{const i=a.target.value;this.partidos||(this.partidos=[]),this.partidos[o]||(this.partidos[o]={}),this.partidos[o][e]=i};const n=B(q);N(n,async a=>{if(a){const e=await this.checkAdminRole(a.uid);this.isAdmin=e,e||T.go("/home")}})}async connectedCallback(){super.connectedCallback(),await this.loadEquipos(),await this.obtenerPartidos()}async obtenerPartidos(){const n=h(),a=u(n,"jornadaSe\xF1alada"),e=j(a),o=await f(e);let i=[];o.forEach(t=>{const l=t.data(),m=l.partidos;this.tituloJornada=l.titulo,Object.entries(m).forEach(([v,b])=>{const y=b;i.push({partidoKey:v,equipoLocal:y.equipoLocal,equipoVisitante:y.equipoVisitante})})}),i.sort((t,l)=>t.partidoKey>l.partidoKey?1:-1),this.partidos2=i}handleOptionClick(n,a,e,o){const i=n.currentTarget;if(this.selectedOptions[a]){const t=this.selectedOptions[a];t&&t.classList.remove("selected")}i.classList.add("selected"),this.selectedOptions[a]=i,this.marcarResultado(e,o)}marcarResultado(n,a){console.log("Se marc\xF3 el resultado ".concat(a," para el partido ").concat(n))}async obtenerJornadas(){const n=h(),a=u(n,"jornadas"),e=await f(a);this.jornadas=e.docs.map(o=>o.data().titulo),this.openSeleccionarJornadas=!0}closeDialogSeleccionarJornadas(){this.openSeleccionarJornadas=!1}closeDialogValidarJornadas(){this.validarJornada=!1}async enviarValidacionJornada(){const n={jornadas:{[this.tituloJornada]:{partidos:{}}}};for(const[o,i]of Object.entries(this.selectedOptions))if(i&&this.partidos2[Number(o)]){const t=i.innerText;n.jornadas[this.tituloJornada].partidos["Partido".concat(Number(o)+1)]=t}const a=h(),e=u(a,"jornadaValidada");(await f(e)).forEach(async o=>{await k(o.ref)});try{await w(e,{quiniela:n}),await this.actualizarPuntuaciones(n)}catch(o){console.error("Error al enviar la quiniela:",o)}}async actualizarPuntuaciones(n){const a=h(),e=u(a,"usuarios");(await f(e)).forEach(async o=>{const i=o.data(),t=o.id,l=i.quinielas;if(l&&l["Jornada 1"]){const m=l["Jornada 1"].partidos;let v=i.puntuacion||0;for(const[b,y]of Object.entries(n.jornadas["Jornada 1"].partidos)){const J=m[b];J&&J===y&&v++}await Q(S(e,t),{puntuacion:v})}})}async enviarJornadaSeleccionada(){const n=h(),a=u(n,"jornadaSe\xF1alada");(await f(a)).forEach(async i=>{await k(i.ref)});const e=u(n,"jornadas"),o=j(e,X("titulo","==",this.jornadaSeleccionada));(await f(o)).forEach(i=>{const t=i.data();t.fechaHoraInicio=this.fechaHoraInicio,w(a,t)})}async seleccionarJornada(n){this.jornadaSeleccionada=n.target.value}activarJornadas(){this.obtenerJornadas()}async loadEquipos(){const n=h(),a=u(n,"equipos");(await f(a)).forEach(e=>{const o=e.data();this.equipos.push(o)}),this.equipos.sort((e,o)=>e.uid-o.uid)}async checkAdminRole(n){try{const a=h(q),e=S(a,"usuarios",n),o=await $(e);if(o.exists()){const i=o.data();return(i==null?void 0:i.userType)==="Admin"}else return!1}catch(a){return console.error("Error al verificar el rol de administrador:",a),!1}}openDialog(){this.open=!0,this.tituloJornada="",this.partidos.forEach((n,a)=>{const e=this.renderRoot.querySelector("#equipo-local-".concat(a)),o=this.renderRoot.querySelector("#equipo-visitante-".concat(a));e.selectedIndex=0,o.selectedIndex=0})}closeDialog(){this.open=!1}async guardarJornada(){const n=h(),a=u(n,"jornadas"),e={};this.partidos.forEach((o,i)=>{e["Partido ".concat(i+1)]={equipoLocal:o.local,equipoVisitante:o.visitante}}),await w(a,{titulo:this.tituloJornada,partidos:e,createdAt:new Date}),this.open=!1,this.partidos=[],this.tituloJornada=""}handleFechaHoraInicio(n){this.fechaHoraInicio=n.target.value}handleOpenValidarJornada(){this.validarJornada=!0}closeDialogNuevaJornada(){this.open=!1}closeDialogActivarJornada(){this.openSeleccionarJornadas=!1}closeDialogValidarJornada(){this.validarJornada=!1}}r([c({type:Boolean})],s.prototype,"isAdmin",void 0),r([c({type:Boolean})],s.prototype,"open",void 0),r([c({type:Boolean})],s.prototype,"openSeleccionarJornadas",void 0),r([c({type:Boolean})],s.prototype,"validarJornada",void 0),r([c({type:String})],s.prototype,"tituloJornada",void 0),r([c({type:Object})],s.prototype,"jornada",void 0),r([c({type:Array})],s.prototype,"equipos",void 0),r([c({type:Date})],s.prototype,"fechaHoraInicio",void 0),r([c({type:Array})],s.prototype,"partidos2",void 0);var E=Object.freeze,M=Object.defineProperty,g=(d,n)=>E(M(d,"raw",{value:E(n||d.slice())})),A,O,V,F,z,R,C,I;class K extends s{static finalizeStyles(n){return[...super.finalizeStyles(n),...x.PanelPageTheme]}renderPartido(n){return p(V||(V=g(["\n            <div>\n                <span>","</span>\n                <select @change=",'>\n                    <option value="">Selecciona equipo local</option>\n                    ','\n                </select>\n                <span>VS</span>\n                <select id="equipo-visitante-','" @change=','>\n                    <option value="">Selecciona equipo visitante</option>\n                    ',"\n                </select>\n            </div>\n        "])),n+1,a=>this.handleEquipoSeleccionado(a,"local",n),this.equipos.map(a=>p(A||(A=g(["<option value=",">","</option>"])),a.nombre,a.nombre)),n,a=>this.handleEquipoSeleccionado(a,"visitante",n),this.equipos.map(a=>p(O||(O=g(["<option value=",">","</option>"])),a.nombre,a.nombre)))}render(){return p(z||(z=g(["\n            <p>Panel de administrador</p>\n\n            <button @click=",'>Crear nueva jornada</button>\n            <dialog ?open="','" @close="','">\n                <span @click=','>X</span>\n                <h2>Crear nueva jornada</h2>\n                <label>T\xEDtulo de la jornada:</label>\n                <input type="text" .value="','" @input="','">\n                <div>\n                    ','\n                </div>\n                <button @click="','">Guardar</button>\n            </dialog>\n    \n            <button @click="','">Activar jornadas</button>\n            <dialog ?open="','" @close="','">\n                <span @click=','>X</span>\n                <h2>Seleccionar jornadas</h2>\n                <label>Selecciona una jornada:</label>\n                <select @change="','">\n                    <option value="">Selecciona una jornada</option>\n                    ','\n                </select>\n                <label>Selecciona fecha y hora de inicio:</label>\n                <input type="datetime-local" @input="','">\n                <button @click="','">Enviar</button>\n            </dialog>\n\n            <button @click="','">Validar jornada</button>\n            <dialog ?open="','" @close="','">\n                <span @click=',">X</span>\n                ",'\n                <button @click="','">Enviar</button>\n            </dialog>\n        '])),this.openDialog,this.open,this.closeDialog,this.closeDialogNuevaJornada,this.tituloJornada,n=>this.tituloJornada=n.target.value,Array.from({length:8}).map((n,a)=>this.renderPartido(a)),this.guardarJornada,this.activarJornadas,this.openSeleccionarJornadas,this.closeDialogSeleccionarJornadas,this.closeDialogActivarJornada,this.seleccionarJornada,this.jornadas.map(n=>p(F||(F=g(["<option value=",">","</option>"])),n,n)),this.handleFechaHoraInicio,this.enviarJornadaSeleccionada,this.handleOpenValidarJornada,this.validarJornada,this.closeDialogValidarJornadas,this.closeDialogValidarJornada,this.renderQuinielaValidar(),this.enviarValidacionJornada)}renderQuinielaValidar(){return p(C||(C=g(['\n            <div class="quiniela">\n                \n                <hr class="pink-line-double">\n                ',"\n            </div>\n        "])),this.partidos2.map((n,a)=>p(R||(R=g(['\n                    <div class="partido">\n                        <div class="equipos">  \n                            <div class="equipo">','</div>\n                            <div class="separator">-</div>\n                            <div class="equipo">','</div>\n                        </div>\n                        \n                        <div class="numPartido">',"</div>\n                        ",'\n                    </div>\n                    <hr class="pink-line-double">\n                '])),n.equipoLocal,n.equipoVisitante,n.partidoKey.charAt(n.partidoKey.length-1),this.renderQuinielaNoRegistrada(a,n))))}renderQuinielaNoRegistrada(n,a){return p(I||(I=g(['\n            <div class="opciones">\n                <div class="elecciones" @click="','">1</div>\n                <div class="elecciones" @click="','">X</div>\n                <div class="elecciones" @click="','">2</div>\n            </div>\n        '])),e=>this.handleOptionClick(e,n,a.partidoKey,"1"),e=>this.handleOptionClick(e,n,a.partidoKey,"X"),e=>this.handleOptionClick(e,n,a.partidoKey,"2"))}}window.customElements.define("panel-page",K);export{K as PanelPageView};
